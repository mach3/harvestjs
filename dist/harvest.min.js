/*!
 * HarvestJS
 * ---------
 * Simple script loader
 * 
 * @version 0.9.1
 * @author mach3 <http://github.com/mach3>
 * @url http://github.com/mach3/harvestjs
 * @license MIT License
 */
 !function(a,b){var c=a._harvest={};c.path=null,c.stack=[],c.Assets=function(){this.items=[],this.nodes=[]},function(){this.supportAsync=void 0!==b.createElement("script").async,this.head=b.getElementsByTagName("head")[0],this.items=null,this.nodes=null,this.count=0,this.callback=null,this.add=function(a){var b=this;return c._each(a,function(a){b.items.push(a)}),this.count=this.items.length,this},this.onComplete=function(a){c._isFunction(a)&&(this.callback=a)},this.load=function(){var a=this;return c._each(this.items,function(d){var e=b.createElement("script");c._on(e,"load",c._bind(a._process,a,e)),c._on(e,"readystatechange",c._bind(a._process,a,e)),e.type="text/javascript",e.src=d,a.supportAsync&&(e.async=!1,a.head.appendChild(e)),a.nodes.push(e),c.stack.push(e)}),this},this._process=function(a,b){if(!a._loaded){var c=this.supportAsync&&"load"===b.type||!this.supportAsync&&"loaded"===a.readyState;c&&(a._loaded=!0,this.count-=1,this.count||this._complete())}},this._complete=function(){var a=this;this.supportAsync||c._each(this.nodes,function(b){a.head.appendChild(b)}),c._isFunction(this.callback)&&this.callback(this)}}.call(c.Assets.prototype),c.loader={el:null,initialize:function(){var a,b,d;a=c._last("script"),b=c._data(a,"path"),"string"!=typeof b&&(b=a.src.replace(/(\?|#).+?$|[^\/]+?$/g,"")),c.path=b,d=this.getAssets(a,"main"),d=this.parse(d),d.length&&c._onReady(c._bind(this.load,this,d))},getAssets:function(a,b){var d=c._data(a,b);return d?d.split(/\s|,/):[]},parse:function(a){var b=[];return c._each(a,function(a){a&&b.push(c.path+a)}),b},load:function(a,b){var d=new c.Assets;d.add(a),d.onComplete(b),d.load()}},c._last=function(a){var b=document.getElementsByTagName(a);return b[b.length-1]},c._data=function(a,b){return a.getAttribute("data-"+b)},c._each=function(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&!1===b(a[c],c,a))break},c._bind=function(){var a,b,c;return a=[].slice.call(arguments),b=a.shift(),c=a.shift(),function(){b.apply(c,a.concat([].slice.call(arguments)))}},c._onReady=function(c){var d=function(){c._done||/^(interactive|complete)$/.test(b.readyState)&&(c._done=!0,c())};this._on(b,"DOMContentLoaded",d),this._on(b,"readystatechange",d),this._on(a,"load",d),d()},c._on=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):void 0},c._isFunction=function(a){return"function"==typeof a},a.harvest=function(){var a,b;a=[].slice.call(arguments),c._isFunction(a[a.length-1])&&(b=a.pop()),c.loader.load(c.loader.parse(a),b)},c.loader.initialize()}(window,document);